<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DersAtÃ¶lyesi</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body { margin:0; font-family: Arial, sans-serif; background:#f2f4f8;}
header { background:#1f3c88; color:white; padding:20px; text-align:center;}
nav { background:#162a5c; padding:10px; text-align:center;}
nav button { background:#2e5cb8; color:white; border:none; padding:10px 15px; margin:5px; cursor:pointer; border-radius:6px;}
.section { display:none; padding:20px;}
.active { display:block;}
.card { display:inline-block; width:180px; margin:10px; padding:15px; background:white; border-radius:12px; text-align:center; box-shadow:0 3px 8px rgba(0,0,0,0.15); cursor:pointer;}
.card:hover { transform: scale(1.05); transition:0.3s;}
.topic-button { display:inline-block; width:200px; margin:8px; padding:12px; background:white; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.2); cursor:pointer;}
.topic-button:hover { background:#dbe6ff;}
.pdf-button { display:inline-block; margin-top:15px; padding:10px 15px; background:#1f3c88; color:white; text-decoration:none; border-radius:6px;}
.chat-box { border:1px solid #ccc; padding:10px; height:300px; overflow-y:auto; background:white; margin-bottom:10px;}
.chat-input { width:80%; padding:10px; border-radius:6px; border:1px solid #ccc;}
.send-btn { padding:10px 15px; border:none; border-radius:6px; background:#1f3c88; color:white; cursor:pointer;}
</style>
</head>
<body>

<header>
<h1>ðŸ“š DersAtÃ¶lyesi</h1>
<p>Ortaokul EÄŸitim Platformu</p>
</header>

<nav>
<button onclick="showSection('home')">Ana Sayfa</button>
<button onclick="showSection('login')">GiriÅŸ / KayÄ±t</button>
</nav>

<!-- ANA SAYFA -->
<div id="home" class="section active">
<h2>HoÅŸ Geldin ðŸ‘‹</h2>
<p>LÃ¼tfen Ã¶nce giriÅŸ yap veya kaydol.</p>
</div>

<!-- GÄ°RÄ°Åž / KAYIT -->
<div id="login" class="section">
<h2>GiriÅŸ / KayÄ±t</h2>
<input type="email" id="email" placeholder="Email" style="padding:10px;width:80%; margin-bottom:10px;"><br>
<input type="password" id="password" placeholder="Åžifre" style="padding:10px;width:80%; margin-bottom:10px;"><br>
<button onclick="register()">KayÄ±t Ol</button>
<button onclick="login()">GiriÅŸ Yap</button>
<button onclick="logout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
<p id="login-msg"></p>
</div>

<!-- SINIF SEÃ‡Ä°MÄ° -->
<div id="grades" class="section">
<h2>SÄ±nÄ±fÄ±nÄ± SeÃ§</h2>
<div class="card" onclick="joinClass('5A')">5-A</div>
<div class="card" onclick="joinClass('6B')">6-B</div>
<div class="card" onclick="joinClass('7C')">7-C</div>
<div class="card" onclick="joinClass('8A')">8-A</div>
<br><br>
<button onclick="showSection('home')">â¬… Geri</button>
</div>

<!-- SINIF SOHBETÄ° -->
<div id="class-chat" class="section">
<h2 id="class-title">SÄ±nÄ±f Sohbeti</h2>
<div class="chat-box" id="chat-box"></div>
<input type="text" id="chat-input" class="chat-input" placeholder="Mesaj yaz...">
<button class="send-btn" onclick="sendMessage()">GÃ¶nder</button>
<br><br>
<button onclick="showSection('grades')">â¬… Geri</button>
</div>

<script>
// 1ï¸âƒ£ Firebase Config (kendi configinle deÄŸiÅŸtir)
const firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "dersatolyesi.firebaseapp.com",
  projectId: "dersatolyesi",
  storageBucket: "dersatolyesi.appspot.com",
  messagingSenderId: "1234567890",
  appId: "1:1234567890:web:abcdef123456"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// GiriÅŸ KayÄ±t
function register() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    auth.createUserWithEmailAndPassword(email,password)
    .then(() => { document.getElementById('login-msg').innerText="KayÄ±t baÅŸarÄ±lÄ±!"; })
    .catch(e => { document.getElementById('login-msg').innerText=e.message; });
}
function login() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    auth.signInWithEmailAndPassword(email,password)
    .then(() => { document.getElementById('login-msg').innerText="GiriÅŸ baÅŸarÄ±lÄ±!"; showSection('grades'); })
    .catch(e => { document.getElementById('login-msg').innerText=e.message; });
}
function logout() { auth.signOut().then(()=>{showSection('login');}); }

// SÄ±nÄ±f seÃ§
let currentClass = '';
function joinClass(cls) {
    currentClass = cls;
    document.getElementById('class-title').innerText = cls + " Sohbeti";
    showSection('class-chat');
    loadMessages();
}

// Chat
function sendMessage() {
    const msg = document.getElementById('chat-input').value;
    if(msg.trim()=='') return;
    const user = auth.currentUser.email;
    db.collection('classes').doc(currentClass).collection('messages').add({
        user: user,
        message: msg,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });
    document.getElementById('chat-input').value='';
}

function loadMessages() {
    const chatBox = document.getElementById('chat-box');
    chatBox.innerHTML='';
    db.collection('classes').doc(currentClass).collection('messages')
      .orderBy('timestamp')
      .onSnapshot(snapshot => {
        chatBox.innerHTML='';
        snapshot.forEach(doc => {
            const data = doc.data();
            const p = document.createElement('p');
            p.innerHTML = `<b>${data.user}:</b> ${data.message}`;
            chatBox.appendChild(p);
            chatBox.scrollTop = chatBox.scrollHeight;
        });
    });
}

// BÃ¶lÃ¼m gÃ¶ster
function showSection(id) {
    document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}
</script>
</body>
</html>
